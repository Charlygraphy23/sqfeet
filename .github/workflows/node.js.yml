# This workflow will do a clean installation of node dependencies, cache/restore them, build the source code and run tests across different versions of node
# For more information see: https://help.github.com/actions/language-and-framework-guides/using-nodejs-with-github-actions

name: Sqfeet CI

on:
  push:
    branches: [main]

jobs:
  vercel:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2
      #  add env file to .env.local

      - name: Set Env Vars on Netlify Project
        uses: netlify/actions/cli@master
        with:
            args: deploy --dir=site --functions=functions
        env:
          DB_URL: ${{ secrets.DB_URL }}
          CLIENT_ID: ${{ secrets.CLIENT_ID }}
          CLIENT_SECRET: ${{ secrets.CLIENT_SECRET }}          
          AUTH_SECRET: ${{ secrets.AUTH_SECRET }}        
          NEXT_PUBLIC_BASE_URL: ${{ secrets.NEXT_PUBLIC_BASE_URL }}
          NETLIFY_SITE_ID: ${{ secrets.NETLIFY_SITE_ID }}
          NETLIFY_AUTH_TOKEN: ${{ secrets.NETLIFY_AUTH_TOKEN }}